!function(e){var a,t,o;a=[],t={},t.main=function(t){var n=this,i,r,s,d,l,p;if("undefined"==typeof t.lat||"undefined"==typeof t.lng)return void e.error("Please provide 'lat' and 'lng' options for jQuery.geolocate");if("undefined"==typeof google||"undefined"==typeof google.maps)return a.push(function(){e(n).geolocate(t)}),void o();if(i=e.extend(!0,{address:[],changeOnEdit:!1,mapOptions:{zoom:14,mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,streetViewControl:!1},markerOptions:{draggable:!0,animation:google.maps.Animation.DROP},geoCallback:function(){}},t),e(this).data("opts",i),r=parseFloat(e(i.lat).val()),s=parseFloat(e(i.lng).val()),isNaN(r)&&(r=0),isNaN(s)&&(s=0),d=new google.maps.LatLng(r,s),e(this).geolocate({},"initMap",d),i.changeOnEdit&&(e(i.lat).change(function(){}),e(i.lng).change(function(){})),p=i.address.length,p>0)for(l=0;p>l;l++)e(i.address[l]).change(function(){e(n).geolocate({},"callGeocoding")})},t.initMap=function(a){var t=e(this).get(0),o=google.maps,n,i,r,s=e.data(t,"opts");n=new o.Map(t,e.extend({center:a},s.mapOptions)),i=e.extend({map:n,position:a},s.markerOptions),r=new o.Marker(i),e.data(t,"map",n),e.data(t,"marker",r),o.event.addListener(r,"dragend",function(){e(t).geolocate({},"getMarkerLocation")})},t.callGeocoding=function(){for(var a=e(this).get(0),t=e.data(a,"opts"),o=t.address.length,n=t.geoCallback,i="",r;o--;)i+=e(t.address[o]).val();r=new google.maps.Geocoder,r.geocode({address:i},function(t,o){var i,r,s,d;n(t,o),r=t[0],"undefined"!=typeof r&&(s=e.data(a,"map"),d=e.data(a,"marker"),i=r.geometry.location,s.panToBounds(r.geometry.viewport),s.panTo(i),d.setPosition(i),e(a).geolocate({},"getMarkerLocation"))})},t.getMarkerLocation=function(){var a=e(this).get(0),t=e.data(a,"marker"),o=e.data(a,"opts"),n=t.getPosition();e(o.lat).val(n.lat()),e(o.lng).val(n.lng())},e.fn.geolocate=function(a,o){var n=Array.prototype.slice;if("undefined"==typeof o){if("string"==typeof a&&"undefined"!=typeof t[a])return t[a].apply(this,n.call(arguments,1));e(this).geolocate({},"main",a)}else{if(t[o])return t[o].apply(this,n.call(arguments,2));e.error("Method "+o+" does not exist on jQuery.geolocate")}return this},e.fn.geolocateGMapsLoaded=function(){for(;a.length;)a.shift()()},o=function(){var e=!1;return function(){var a;e||(e=!0,a=document.createElement("script"),a.type="text/javascript",a.src="http://maps.googleapis.com/maps/api/js?sensor=false&callback=$.fn.geolocateGMapsLoaded",document.body.appendChild(a))}}()}(jQuery);